<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Iron Fist Tournament</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Poppins,sans-serif;
  background:radial-gradient(circle,#1a1a1a,#000);
  color:#fdd835;
  text-align:center;
  margin:0
}
h1{color:red;text-shadow:0 0 15px red;font-size:40px}
button{
  cursor:pointer;
  padding:5px 12px;
  border:none;
  border-radius:6px;
  margin:3px;
  font-weight:600
}
.win-btn{background:red;color:#fff}
.reset-btn{background:#ff3d00;color:#fff}
.completed-match{
  background:rgba(0,255,0,.15);
  border:1px solid #00ff37;
  box-shadow:0 0 10px #00ff3744;
  border-radius:6px;
  padding:5px
}
.tick{color:#00ff37;font-weight:bold;margin-left:6px}
table{
  margin:25px auto;
  border-collapse:collapse;
  width:80%;
  max-width:900px;
  background:rgba(0,0,0,.7)
}
th,td{border:1px solid #fdd83566;padding:8px}
th{background:#222}
.round-title{font-size:22px;margin-top:40px}
</style>
</head>

<body>

<h1>Iron Fist Tournament</h1>
<button onclick="resetAll()" class="reset-btn">üîÑ Reset All</button>

<h2 class="round-title">League Stage</h2>
<div id="matches"></div>

<h2 class="round-title">Leaderboard (Top 32 Qualify)</h2>
<table>
<thead><tr><th>Rank</th><th>Player</th><th>Points</th></tr></thead>
<tbody id="leaderboard"></tbody>
</table>

<h2 class="round-title">Knockout Rounds</h2>
<div id="knockout"></div>

<script>
const players=["Naruto","Kakashi","Sai","Sakura","Neji","Rocklee","Tenten","Might Guy","Shikamaru","Ino","Choji","Asuma","Kiba","Shino","Hinata","Kurenai","Sasuke","Suigetsu","Karin","Jugo","Deidara","Hiruiko","Sasori","Tobi","Itachi","Kisame","Hidan","Kakuzu","Konan","Pain","Gaara","Temari","Kankuro","Chiyo","Yamato","Shizune","Tsunade","Jiraiya","Kabuto","Orochimaru","Minato","Small Obito","Small Kakashi","Hashirama"];

let matches=[],scores={},KO={
  r32:[],r16:[],qf:[],sf:[],final:[],champion:null
};

function save(){localStorage.setItem("ironFist",JSON.stringify({matches,scores,KO}))}
function load(){
  let d=JSON.parse(localStorage.getItem("ironFist"));
  if(!d) return false;
  matches=d.matches; scores=d.scores; KO=d.KO; return true;
}

function init(){
 if(!load()){
  players.forEach(p=>scores[p]={points:0});
  for(let i=0;i<players.length;i++)
   for(let j=i+1;j<i+4 && j<players.length;j++)
    matches.push({p1:players[i],p2:players[j],winner:null});
 }
 renderLeague(); renderLeaderboard(); renderKO();
}

function renderLeague(){
 let d=document.getElementById("matches"); d.innerHTML="";
 matches.forEach((m,i)=>{
  let done=m.winner?`class="completed-match"`:"";
  let tick=m.winner?`<span class="tick">‚úî</span>`:"";
  d.innerHTML+=`
  <p ${done}>${m.p1} vs ${m.p2}
  <button class="win-btn" onclick="winLeague(${i},1)">Win</button>
  <button class="win-btn" onclick="winLeague(${i},2)">Win</button>
  ${tick}</p>`;
 });
}

function winLeague(i,w){
 if(matches[i].winner) return;
 let win=w===1?matches[i].p1:matches[i].p2;
 matches[i].winner=win;
 scores[win].points+=3;
 save(); renderLeague(); renderLeaderboard();
}

function renderLeaderboard(){
 let arr=Object.keys(scores).map(p=>({p,pt:scores[p].points}))
 .sort((a,b)=>b.pt-a.pt);
 let tb=document.getElementById("leaderboard"); tb.innerHTML="";
 arr.forEach((x,i)=>tb.innerHTML+=
 `<tr><td>${i+1}</td><td>${x.p}</td><td>${x.pt}</td></tr>`);
 if(!KO.r32.length) buildKO(arr.slice(0,32).map(x=>x.p));
}

function buildKO(list){
 KO={r32:[],r16:[],qf:[],sf:[],final:[],champion:null};
 for(let i=0;i<16;i++)
  KO.r32.push({p1:list[i],p2:list[31-i],winner:null});
 save(); renderKO();
}

function renderKO(){
 let d=document.getElementById("knockout"); d.innerHTML="";
 renderRound("Round of 32","r32","r16",16);
 renderRound("Round of 16","r16","qf",8);
 renderRound("Quarterfinals","qf","sf",4);
 renderRound("Semifinals","sf","final",2);
 renderFinal();
}

function renderRound(title,r,next,count){
 if(!KO[r].length) return;
 let h=`<h3>${title}</h3>`;
 KO[r].forEach((m,i)=>{
  let done=m.winner?`class="completed-match"`:"";
  let tick=m.winner?`<span class="tick">‚úî</span>`:"";
  h+=`
  <p ${done}>${m.p1} vs ${m.p2}
  <button class="win-btn" onclick="winKO('${r}','${next}',${i},1)">Win</button>
  <button class="win-btn" onclick="winKO('${r}','${next}',${i},2)">Win</button>
  ${tick}</p>`;
 });
 document.getElementById("knockout").innerHTML+=h;
}

function winKO(r,next,i,w){
 let m=KO[r][i]; if(m.winner) return;
 m.winner=w===1?m.p1:m.p2;
 if(next){
  if(!KO[next]) KO[next]=[];
  KO[next].push({p1:null,p2:null,winner:m.winner});
 }
 if(KO[r].every(x=>x.winner)) buildNext(r,next);
 save(); renderKO();
}

function buildNext(r,next){
 let winners=KO[r].map(x=>x.winner);
 KO[next]=[];
 for(let i=0;i<winners.length/2;i++)
  KO[next].push({p1:winners[i],p2:winners[winners.length-1-i],winner:null});
}

function renderFinal(){
 if(!KO.final.length) return;
 let m=KO.final[0];
 let tick=m.winner?`<span class="tick">‚úî</span>`:"";
 document.getElementById("knockout").innerHTML+=`
 <h3>Final</h3>
 <p class="${m.winner?"completed-match":""}">
 ${m.p1} vs ${m.p2}
 <button class="win-btn" onclick="finish(1)">Win</button>
 <button class="win-btn" onclick="finish(2)">Win</button>
 ${tick}</p>`;
}

function finish(w){
 let m=KO.final[0]; if(m.winner) return;
 m.winner=w===1?m.p1:m.p2;
 KO.champion=m.winner;
 save();
 document.getElementById("knockout").innerHTML+=`<h2>üèÜ Champion: ${KO.champion}</h2>`;
}

function resetAll(){
 if(!confirm("Reset everything?"))return;
 localStorage.removeItem("ironFist");
 location.reload();
}

init();
</script>
</body>
</html>
